# FFT実装方程式

## ハンウィンドウ関数
スペクトル漏れを減少させるために使用されるハンウィンドウ関数は以下のように定義されます：

$$w(n) = 0.5 \times \left(1 - \cos\left(2\pi \frac{n}{N-1}\right)\right)$$

ここで：
- $w(n)$ はサンプル $n$ でのウィンドウ値
- $N$ はウィンドウ長（我々の実装では1024）

## 周波数計算
FFTビンインデックスと周波数の関係：

$$f = \frac{k \times f_s}{N}$$

ここで：
- $f$ はHz単位の周波数
- $k$ はビンインデックス
- $f_s$ はサンプリングレート（44.1kHz）
- $N$ はFFTサイズ（1024）

これにより、音声分析に十分な約43Hzのビンあたりの周波数分解能が得られます。

## ピーク周波数検出
FFT計算の後、各ビンの振幅は以下のように計算されます：

$$X_{mag}[k] = \sqrt{X_{real}[k]^2 + X_{imag}[k]^2}$$

支配的な周波数は最大振幅を持つビンに対応します：

$$k_{max} = \arg\max_k X_{mag}[k]$$
$$f_{dominant} = \frac{k_{max} \times f_s}{N}$$

## バッファサイズの考慮事項
バッファサイズは以下に影響します：

時間分解能: $\Delta t = \frac{N}{f_s}$

周波数分解能: $\Delta f = \frac{f_s}{N}$

N = 1024 および $f_s$ = 44.1kHz の場合：
- 時間分解能：約23ms
- 周波数分解能：約43Hz
